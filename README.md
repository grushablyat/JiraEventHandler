# Обработчик событий Jira для отправки уведомлений [jira_bot](https://github.com/grushablyat/jira_bot)

## Описание

Данный обработчик событий Jira является частью проекта [jira_bot](https://github.com/grushablyat/jira_bot) и играет роль уведомителя об изменении статусов задач.
Обработчик отправляет HTTP-запрос, принимаемый Flask-приложением в составе jira_bot.

## Требования

- Jira Software Server (не Jira Cloud)
- Adaptavist Scriptrunner

## Настройка

Авторизируйтесь в Jira в качестве администратора

### Создание пользовательского события

- Нажмите ⚙️ > **Система**, на левой боковой панели в категории **Дополнительно** выбиретие **События**
- Введите название события (к примеру, **Transition Made**, **Issue Transited**) и описание (опционально)
- В качестве образца выберите **Generic Event** (**Типовое событие**)
- Нажмите **Добавить**

![image](https://github.com/user-attachments/assets/34adf580-d342-4c6e-8e8f-e601767d0751)

### Добавление пост-функции

- Нажмите ⚙️ > **Задачи**, на левой боковой панели в категории **Бизнес-процессы** выбиретие **Бизнес-процессы**
- Выберите действие **Редактировать** у бизнес-процесса, который хотите настроить (в примере - **Task Management**)
- Выберите переход, при выполнении которого нужно высылать уведомление автору задачи (в примере - **Start Progress**)
- В меню справа выберите пункт **Пост-функции**

![image](https://github.com/user-attachments/assets/f1c71056-db01-4e72-a607-418ea8dd286d)

- Наведите курсор на пост-функцию **Запустить Типовое Событие событие, которое может быть обработано приемником.** щелкните на значок карандаша, чтобы изменить пост-функцию
- Измените **Типовое событие** на выше пользовательское событие, после чего нажмите **Обновить**

![image](https://github.com/user-attachments/assets/dd0160a3-1ac9-40b8-a150-be4238245e2b)

- Опубликуйте изменения бизнес-процесса.

### Создание обработчика событий

- Нажмите ⚙️ > **ScriptRunner**, на левой боковой панели или на панели задач ScriptRunner выбиретие **Listeners**
- Нажмите **Create Listener** и выберите вариант **Custom Listener**
- Введите название обработчика (опционально) и выберите, к каким проектам будет применен обработчик (по умолчанию ко всем - **Global**)
- В графе **События** выберите свое пользовательское событие
- В поле **Script** вставьте код _**src/JiraEventHandler.groovy**_ (замените URL на свой собственный, на котором запущен бот)
- Нажмите **Add**

![image](https://github.com/user-attachments/assets/11498aab-bdf6-4396-99f7-242064d01018)

Инструкцию по настройке бота смотри [здесь](https://github.com/grushablyat/jira_bot)
